<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotnews-çƒ­ç‚¹æ–°é—»</title>
    <!-- èµ„æºé¢„åŠ è½½æç¤º -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="preload" href="{{ static_prefix }}/css/viewer.css?v=20251223_1841" as="style">
    <link rel="preload" href="{{ static_prefix }}/js/viewer.bundle.js?v=20251223_1841" as="script">
    <!-- æ—©æœŸéšè—è„šæœ¬ï¼šåœ¨ DOM è§£æå‰æ£€æµ‹ç”¨æˆ·é…ç½®ï¼Œé˜²æ­¢æ ç›®é—ªçƒ -->
    <script>
    (function(){try{var r=localStorage.getItem('trendradar_categories_config');if(r){var c=JSON.parse(r);if((c.customCategories&&c.customCategories.length>0)||(c.hiddenDefaultCategories&&c.hiddenDefaultCategories.length>0)){document.write('<style id="early-hide">.category-tabs,.tab-content-area{display:none!important}</style>');}}}catch(e){}})();
    </script>
    <!-- ç™¾åº¦ç»Ÿè®¡ -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?66fb2effb4714e3c3f0b0c0053b8dc83";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <!-- å…³é”® CSS å†…è”ï¼ˆéª¨æ¶å±æ ·å¼ï¼Œé˜²æ­¢ FOUCï¼‰ -->
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif; }
        .main-container { max-width: 1400px; margin: 0 auto; padding: 24px 15px; }
        .header-card { background: white; border-radius: 12px; padding: 12px 15px; margin-bottom: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .category-tabs { display: flex; gap: 8px; flex-wrap: wrap; background: white; border-radius: 12px; padding: 10px; margin-bottom: 10px; }
        .category-tab { padding: 8px 16px; border-radius: 8px; background: #f3f4f6; cursor: pointer; }
        .category-tab.active { background: linear-gradient(135deg, #4f46e5, #7c3aed); color: white; }
        .platform-card { background: white; border-radius: 10px; padding: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: skeleton-loading 1.5s infinite; }
        @keyframes skeleton-loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ static_prefix }}/css/viewer.css?v=20251223_1841" rel="stylesheet">
</head>
<body>
    <div class="main-container">
        <!-- Header -->
        <div class="header-card">
            <div class="header-top">
                <a href="https://github.com/sundt/TrendRadar-Plus" target="_blank" class="header-title" style="text-decoration: none; color: inherit;"><svg height="24" width="24" viewBox="0 0 16 16" style="vertical-align: middle;"><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a>
                <span class="header-subtitle">æ™ºèƒ½åˆ†ç±» Â· ç²¾å‡†è¿‡æ»¤ Â· é«˜æ•ˆé˜…è¯»</span>
            </div>

            <div class="stats-row">
                <div class="stat-card" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                    <span class="stat-label">æ›´æ–°</span>
                    <span class="stat-value" id="updatedAt">{{ data.updated_at }}</span>
                    <span class="online-chips" id="onlineChips" title="å®æ—¶åœ¨çº¿ï¼šæŒ‰æœ€è¿‘æ´»è·ƒæ—¶é—´ç»Ÿè®¡">
                        <span class="online-chip">åœ¨çº¿ <b id="online5m">-</b></span>
                    </span>
                </div>
                <button class="category-settings-btn" onclick="openCategorySettings()">
                    âš™ï¸ æ ç›®è®¾ç½® <span class="new-badge" id="categorySettingsNewBadge">NEW</span>
                </button>
                <button class="show-read-btn" id="showReadBtn" onclick="toggleShowRead()">
                    ğŸ‘ å·²è¯»: <span id="readCount">0</span>
                </button>
                <button class="filter-toggle-btn" type="button" onclick="window.open('https://p2fjebt29i.feishu.cn/share/base/form/shrcnL6g8L6M6yFJU9gTnE4pBqe', '_blank')">
                    ğŸ’¡ å»ºè®®
                </button>
            </div>

            <!-- è¿‡æ»¤é¢æ¿ -->
            <div class="filter-panel" id="filterPanel" style="display:none;"></div>

            <div style="margin-top: 8px; display: flex; gap: 8px; align-items: center;">
                <input type="text" class="form-control form-control-sm" id="searchInput" placeholder="ğŸ” æœç´¢æ–°é—»..." onkeyup="searchNews()" style="flex: 1; font-size: 0.8rem; padding: 4px 8px;">
            </div>
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="fetch-status" id="fetchStatus"></div>
        </div>

        <!-- Tabs -->
        <div class="category-tabs">
            {% for cat_id, category in data.categories.items() %}
            <div class="category-tab {% if loop.first %}active{% endif %}" 
                 data-category="{{ cat_id }}"
                 onclick="switchTab('{{ cat_id }}')">
                <div class="category-tab-icon">{{ category.icon }}</div>
                <div class="category-tab-name">{{ category.name }}{% if category.is_new %}<span class="new-badge new-badge-category" data-category="{{ cat_id }}">NEW</span>{% endif %}{% if cat_id == 'sports' %}<span class="new-badge" id="newBadgeSportsTab" style="display:none;">NEW</span>{% endif %}</div>
            </div>
            {% endfor %}
        </div>

        <!-- Content -->
        <div class="tab-content-area">
            {% for cat_id, category in data.categories.items() %}
            <div class="tab-pane {% if loop.first %}active{% endif %}" id="tab-{{ cat_id }}">
                <div class="platform-grid">
                    {% for platform_id, platform in category.platforms.items() %}
                    <div class="platform-card" data-platform="{{ platform_id }}">
                        <div class="platform-header">
                            <div class="platform-name" style="margin-bottom: 0; padding-bottom: 0; border-bottom: none; cursor: pointer;" onclick="dismissNewPlatformBadge('{{ platform_id }}')">
                                ğŸ“± {{ platform.name }}
                                {% if platform.is_new %}<span class="new-badge new-badge-platform" data-platform="{{ platform_id }}">NEW</span>{% endif %}
                            </div>
                        </div>
                        <ul class="news-list">
                            {% for news in platform.news %}
                            <li class="news-item{% if loop.index > 20 %} paged-hidden{% endif %}" data-news-id="{{ news.stable_id }}" data-news-title="{{ news.display_title or news.title }}">
                                <div class="news-item-content">
                                    <input type="checkbox" class="news-checkbox" onchange="markAsRead(this)" title="æ ‡è®°å·²è¯»">
                                    <span class="news-index">{{ loop.index }}</span>
                                    <a class="news-title {% if news.is_cross_platform %}cross-platform{% endif %}" href="{{ news.url or '#' }}" target="_blank" rel="noopener noreferrer" onclick="handleTitleClickV2(this, event)" onauxclick="handleTitleClickV2(this, event)" oncontextmenu="handleTitleClickV2(this, event)" onkeydown="handleTitleKeydownV2(this, event)">
                                        {{ news.display_title or news.title }}
                                        {% if news.is_cross_platform %}
                                        <span class="cross-platform-badge" title="åŒæ—¶å‡ºç°åœ¨: {{ news.cross_platforms|join(', ') }}">
                                            ğŸ”¥ {{ news.cross_platform_count }}
                                        </span>
                                        {% endif %}
                                    </a>
                                </div>
                                {% if news.meta %}<div class="news-subtitle">{{ news.meta }}</div>{% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- æ ç›®è®¾ç½®å¼¹çª— -->
    <div class="settings-modal-overlay" id="categorySettingsModal" onclick="closeCategorySettingsOnOverlay(event)">
        <div class="settings-modal" onclick="event.stopPropagation()">
            <div class="settings-modal-header">
                <span class="settings-modal-title">âš™ï¸ æ ç›®è®¾ç½®</span>
                <button class="settings-modal-close" onclick="closeCategorySettings()">&times;</button>
            </div>
            <div class="settings-modal-body">
                <div class="settings-section">
                    <button class="add-category-btn" onclick="showAddCategoryPanel()">+ æ–°å¢è‡ªå®šä¹‰æ ç›®</button>
                </div>
                <div class="category-edit-panel" id="categoryEditPanel">
                    <div class="edit-field">
                        <label>æ ç›®åç§°</label>
                        <input type="text" id="editCategoryName" placeholder="è¾“å…¥æ ç›®åç§°">
                    </div>
                    <div class="edit-field">
                        <label>é€‰æ‹©å¹³å° <span style="font-weight:normal;color:#6b7280;">(æ‹–æ‹½æ’åº)</span></label>
                        <div class="platform-select-toolbar">
                            <input class="platform-select-search" type="text" id="platformSearchInput" placeholder="æœç´¢å¹³å°..." oninput="setPlatformSearchQuery(this.value)">
                            <div class="platform-select-actions">
                                <button class="platform-select-action-btn" type="button" onclick="bulkSelectPlatforms('all')">å…¨é€‰</button>
                                <button class="platform-select-action-btn" type="button" onclick="bulkSelectPlatforms('none')">å…¨ä¸é€‰</button>
                                <button class="platform-select-action-btn" type="button" onclick="bulkSelectPlatforms('clear')">æ¸…ç©º</button>
                            </div>
                        </div>
                        <div class="platform-select-list" id="platformSelectList"></div>
                    </div>
                    <div class="edit-field">
                        <label>å…³é”®è¯è¿‡æ»¤</label>
                        <div class="filter-input-row">
                            <label class="filter-mode-toggle" title="å…³é”®è¯æ¨¡å¼ï¼šè¿‡æ»¤=éšè—å‘½ä¸­å…³é”®è¯ï¼›æ˜¾ç¤º=åªæ˜¾ç¤ºå‘½ä¸­å…³é”®è¯">
                                <input type="checkbox" id="categoryFilterModeToggle" onchange="handleCategoryFilterModeToggle(this)">
                                <span class="filter-mode-pill">
                                    <span class="filter-mode-thumb"></span>
                                    <span class="filter-mode-off">è¿‡æ»¤</span>
                                    <span class="filter-mode-on">æ˜¾ç¤º</span>
                                </span>
                            </label>
                            <input type="text" class="filter-input" id="categoryFilterInput" placeholder="è¾“å…¥å…³é”®è¯ï¼Œå›è½¦æ·»åŠ ..." onkeypress="handleCategoryFilterKeypress(event)">
                            <button class="filter-add-btn" onclick="addCategoryFilterKeyword()">+ æ·»åŠ </button>
                        </div>
                        <div class="filter-tags" id="categoryFilterTags"></div>
                    </div>
                </div>

                <div class="category-list-controls">
                    <div class="settings-section-title" style="margin:0;">
                        <button class="platform-select-action-btn" id="categoryListToggleBtn" type="button" onclick="toggleCategoryListCollapseInSettings()">æ”¶èµ·æ ç›®åˆ—è¡¨</button>
                        <span style="font-weight:normal;color:#6b7280;font-size:0.75rem;">(æ‹–æ‹½æ’åº)</span>
                    </div>
                </div>
                <div class="category-list-wrapper collapsed" id="categoryListWrapper">
                    <div class="category-list" id="categoryList"></div>
                </div>
            </div>
            <div class="settings-modal-footer">
                <button class="settings-btn-secondary" onclick="cancelCategorySettings()">å–æ¶ˆ</button>
                <button class="settings-btn-primary" onclick="saveCategorySettings()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <script src="{{ static_prefix }}/js/viewer.bundle.js?v=20251223_1841"></script>
</body>
</html>
